@page "/add-entry"
@using MySimpleDictionaryApp.Data
@using MudBlazor
@inject MySimpleDictionaryService DictService

<MudPaper Class="pa-6 mx-auto" Elevation="6" Style="max-width:400px;">
    <MudText Typo="Typo.h4" Class="mb-5" Align="Align.Center">Dodaj unos u dictionary</MudText>

    <MudGrid Spacing="3">
        <MudItem xs="12">
            <MudTextField @bind-Value="KeyInput" Label="Key" Variant="Variant.Outlined" Required="true" Immediate="true" />
        </MudItem>
        <MudItem xs="12">
            <MudTextField @bind-Value="ValueInput" Label="Value" Variant="Variant.Outlined" Required="true" Immediate="true" />
        </MudItem>
        <MudItem xs="12" Class="d-flex justify-center">
            <MudButton OnClick="AddEntryClicked"
                       Disabled="@(!CanAdd)"
                       Color="Color.Primary"
                       Variant="Variant.Filled"
                       Size="Size.Medium"
                       StartIcon="@Icons.Material.Filled.AddCircle">
                Dodaj
            </MudButton>
        </MudItem>
    </MudGrid>

    @if (ErrorMessage != null)
    {
        <MudText Color="Color.Error" Class="mt-4" Align="Align.Center">@ErrorMessage</MudText>
    }
</MudPaper>

@code {
    private string KeyInput = "";
    private string ValueInput = "";
    private string? ErrorMessage;

    private bool CanAdd => !string.IsNullOrWhiteSpace(KeyInput) && !string.IsNullOrWhiteSpace(ValueInput);

    private void AddEntryClicked()
    {
        try
        {
            DictService.Add(KeyInput, ValueInput);
            KeyInput = "";
            ValueInput = "";
            ErrorMessage = null;
        }
        catch (ArgumentException)
        {
            ErrorMessage = $"Key '{KeyInput}' već postoji!";
        }
    }
}
